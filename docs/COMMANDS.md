# 命令参考手册

本文档列出了 UI-Agent 支持的所有命令及其使用方法。

## 目录

- [窗口管理](#窗口管理)
- [文件操作](#文件操作)
- [编辑操作](#编辑操作)
- [导航操作](#导航操作)
- [重构操作](#重构操作)
- [运行操作](#运行操作)
- [搜索操作](#搜索操作)

## 窗口管理

### 激活窗口 / 切换窗口

**命令别名**: `激活窗口`, `切换到 PyCharm`, `切换窗口`, `activate window`

**参数**: 无（使用配置的默认窗口）或 `window_title` - 窗口标题

**示例**:
```
激活窗口
切换到 PyCharm
激活 VSCode
```

**说明**: 将指定窗口置于前台。如果窗口被最小化，会自动恢复。主要用于在执行其他操作前确保目标 IDE 窗口处于活动状态。

**支持的 IDE**:
- PyCharm（默认）
- Visual Studio Code
- WebStorm
- IntelliJ IDEA
- 其他可通过窗口标题匹配的应用

**注意事项**:
- 如果目标应用以管理员权限运行，需要以管理员身份运行 UI-Agent
- 窗口标题支持部分匹配（如"PyCharm"会匹配所有包含"PyCharm"的窗口）
- 如果存在多个匹配窗口，将激活第一个找到的窗口

---

### 列出窗口

**命令别名**: `列出窗口`, `显示窗口`, `list windows`

**参数**: `filter` (可选) - 窗口标题过滤关键词

**示例**:
```
列出所有窗口
列出包含 PyCharm 的窗口
显示当前窗口
```

**说明**: 列出系统中所有可见窗口的标题，便于查找目标窗口名称。

---

## 文件操作

### 双击文件 / 打开文件

**命令别名**: `双击`, `双击文件`, `打开文件`, `open file`, `double click file`

**参数**: `filename` - 文件名或关键字

**示例**:
```
双击 main.py
打开 utils.py
点击 config.yaml
```

**说明**: 在文件树中找到并双击指定的文件节点

---

### 保存文件

**命令别名**: `保存`, `保存文件`, `save file`

**参数**: 无

**示例**:
```
保存
保存当前文件
```

**快捷键**: `Ctrl+S`

---

### 关闭文件

**命令别名**: `关闭`, `关闭文件`, `close file`

**参数**: 无

**示例**:
```
关闭
关闭当前文件
```

**快捷键**: `Ctrl+F4`

---

### 新建文件

**命令别名**: `新建`, `新建文件`, `new file`

**参数**: `filename` - 新文件名

**示例**:
```
新建 test.py
新建文件 helpers.py
```

**快捷键**: `Alt+F`

---

## 编辑操作

### 复制行

**命令别名**: `复制行`, `copy line`

**参数**: 无

**示例**:
```
复制行
复制当前行
```

**快捷键**: `Ctrl+D`

---

### 删除行

**命令别名**: `删除行`, `delete line`

**参数**: 无

**示例**:
```
删除行
删除当前行
```

**快捷键**: `Ctrl+Y`

---

### 撤销

**命令别名**: `撤销`, `undo`

**参数**: 无

**示例**:
```
撤销
撤销上一步
```

**快捷键**: `Ctrl+Z`

---

### 重做

**命令别名**: `重做`, `redo`

**参数**: 无

**示例**:
```
重做
恢复操作
```

**快捷键**: `Ctrl+Shift+Z`

---

### 切换注释

**命令别名**: `注释`, `切换注释`, `toggle comment`

**参数**: 无

**示例**:
```
注释
切换注释
注释当前行
```

**快捷键**: `Ctrl+/`

---

## 导航操作

### 跳转到行

**命令别名**: `跳转`, `跳转到行`, `go to line`

**参数**: `line_number` - 目标行号

**示例**:
```
跳转到第 50 行
跳转 100
转到第 20 行
```

**快捷键**: `Ctrl+G`

---

### 查找文件

**命令别名**: `查找文件`, `搜索文件`, `find file`

**参数**: `filename` - 文件名

**示例**:
```
查找文件 main.py
搜索 utils.py
找到 test_helpers.py
```

**快捷键**: `Ctrl+Shift+N`

---

## 重构操作

### 重命名符号

**命令别名**: `重命名`, `rename`, `refactor_rename`

**参数**: `new_name` - 新名称

**示例**:
```
重命名为 new_function
重命名符号为 MyClass
将当前函数改名为 process_data
```

**快捷键**: `Shift+F6`

**风险等级**: 中等（需要确认）

---

### 格式化代码

**命令别名**: `格式化`, `格式化代码`, `format code`

**参数**: 无

**示例**:
```
格式化
格式化代码
格式化当前文件
```

**快捷键**: `Ctrl+Alt+L`

---

### 提取方法

**命令别名**: `提取方法`, `extract method`

**参数**: 无

**示例**:
```
提取方法
提取选中的代码为方法
```

**快捷键**: `Ctrl+Alt+M`

**风险等级**: 中等（需要确认）

---

### 优化导入

**命令别名**: `优化导入`, `optimize imports`

**参数**: 无

**示例**:
```
优化导入
清理未使用的导入
```

**快捷键**: `Ctrl+Alt+O`

---

## 运行操作

### 运行当前文件

**命令别名**: `运行`, `运行当前文件`, `run`

**参数**: 无

**示例**:
```
运行
运行当前文件
执行程序
```

**快捷键**: `Ctrl+Shift+F10`

---

### 调试当前文件

**命令别名**: `调试`, `调试当前文件`, `debug`

**参数**: 无

**示例**:
```
调试
调试当前文件
启动调试器
```

**快捷键**: `Shift+F9`

---

### 停止运行

**命令别名**: `停止`, `停止运行`, `stop`

**参数**: 无

**示例**:
```
停止
停止运行
终止程序
```

**快捷键**: `Ctrl+F2`

---

## 搜索操作

### 在文件中查找

**命令别名**: `查找`, `在文件中查找`, `find`

**参数**: `search_text` - 搜索文本

**示例**:
```
查找 function_name
搜索 "TODO"
找到 utils
```

**快捷键**: `Ctrl+F`

---

### 在项目中查找

**命令别名**: `全局搜索`, `在项目中查找`, `find in project`

**参数**: `search_text` - 搜索文本

**示例**:
```
全局搜索 MyClass
在项目中查找 "import"
搜索所有出现
```

**快捷键**: `Ctrl+Shift+F`

---

## 命令格式说明

### 参数提取规则

1. **带引号的字符串**: 优先提取
   ```
   打开 "test file.py"  → 提取: test file.py
   ```

2. **文件扩展名**: 自动识别
   ```
   打开 main.py  → 提取: main.py
   ```

3. **数字**: 行号自动识别
   ```
   跳转到 50  → 提取行号: 50
   ```

4. **关键字**: 匹配操作后的词汇
   ```
   重命名为 new_name  → 提取: new_name
   ```

### 命令别名

每个命令支持多种表达方式，系统会自动识别意图。例如：
- "打开 main.py" = "双击 main.py" = "点击 main.py 文件"

### 风险等级

某些操作被标记为具有风险，执行前会要求确认：
- **中等风险**: 重命名符号、提取方法等

## 参数占位符

在配置文件中，使用以下占位符表示动态参数：

| 占位符 | 说明 | 示例 |
|-------|------|------|
| `{filename}` | 文件名 | `main.py` |
| `{line_number}` | 行号 | `50` |
| `{new_name}` | 新名称 | `new_function` |
| `{search_text}` | 搜索文本 | `import` |

## 快捷键参考

| 操作 | Windows/Linux | macOS |
|------|--------------|-------|
| 保存 | `Ctrl+S` | `Cmd+S` |
| 关闭文件 | `Ctrl+F4` | `Cmd+W` |
| 跳转行 | `Ctrl+G` | `Cmd+L` |
| 查找文件 | `Ctrl+Shift+N` | `Cmd+Shift+O` |
| 重命名 | `Shift+F6` | `Shift+F6` |
| 格式化 | `Ctrl+Alt+L` | `Cmd+Alt+L` |
| 运行 | `Ctrl+Shift+F10` | `Ctrl+R` |
| 调试 | `Shift+F9` | `Ctrl+D` |
| 撤销 | `Ctrl+Z` | `Cmd+Z` |
| 重做 | `Ctrl+Shift+Z` | `Cmd+Shift+Z` |

> 注意: macOS 快捷键可能因 PyCharm 版本而异

## 扩展命令

要添加自定义命令，请参考 [扩展指南](EXTENDING.md)。
